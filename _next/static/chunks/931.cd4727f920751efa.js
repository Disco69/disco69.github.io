"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{2931:(e,t,a)=>{a.d(t,{loadUserPlan:()=>c,saveUserPlan:()=>s});var r=a(4479);let n={USER_PLAN:"finance-planner-user-plan",BACKUP_DATA:"finance-planner-backup"};function o(){try{let e="__storage_test__";return window.localStorage.setItem(e,e),window.localStorage.removeItem(e),!0}catch(e){return!1}}function l(e){try{return JSON.stringify(e)}catch(e){return console.error("Failed to stringify data:",e),null}}async function s(e){if(!o())throw Error("localStorage is not available");try{await i(e);let t="default-plan"===e.id?{...e,id:"user-plan-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),updatedAt:new Date().toISOString()}:{...e,updatedAt:new Date().toISOString()},a=l(t);if(!a)throw Error("Failed to serialize user plan");window.localStorage.setItem(n.USER_PLAN,a);let r={lastSaved:new Date().toISOString(),version:"1.0.0"};return window.localStorage.setItem("".concat(n.USER_PLAN,"-metadata"),l(r)||"{}"),console.log("✅ User plan saved successfully"),t}catch(e){throw console.error("❌ Failed to save user plan:",e),Error("Failed to save user plan to storage")}}async function c(){if(!o())return console.warn("localStorage is not available"),null;try{let e=window.localStorage.getItem(n.USER_PLAN);if(!e)return console.log("No saved user plan found"),null;let t=function(e,t){try{return JSON.parse(e)||null}catch(e){return console.warn("Failed to parse JSON data, using fallback"),null}}(e,null);if(!t)return console.warn("Invalid user plan data found in storage"),null;let a=function(e){let t={...e};return t.forecastConfig||(t.forecastConfig={...r.W6,startingBalance:t.currentBalance||0}),t}(t);if(!function(e){try{return e&&"object"==typeof e&&"string"==typeof e.id&&Array.isArray(e.income)&&Array.isArray(e.expenses)&&Array.isArray(e.goals)&&Array.isArray(e.forecast)&&"number"==typeof e.currentBalance&&e.forecastConfig&&"object"==typeof e.forecastConfig&&"number"==typeof e.forecastConfig.startingBalance&&"string"==typeof e.forecastConfig.startDate&&"number"==typeof e.forecastConfig.months&&"boolean"==typeof e.forecastConfig.includeGoalContributions&&"boolean"==typeof e.forecastConfig.conservativeMode&&"string"==typeof e.forecastConfig.updatedAt&&"string"==typeof e.createdAt&&"string"==typeof e.updatedAt}catch(e){return!1}}(a))return console.warn("Loaded user plan failed validation"),null;return console.log("✅ User plan loaded successfully"),a}catch(e){return console.error("❌ Failed to load user plan:",e),null}}async function i(e){if(o())try{let t={userPlan:e,timestamp:new Date().toISOString(),version:"1.0.0"},a=l(t);a&&window.localStorage.setItem(n.BACKUP_DATA,a)}catch(e){console.warn("Failed to create backup:",e)}}}}]);