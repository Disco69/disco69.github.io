"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[880],{2733:(t,e,n)=>{n.d(e,{Qn:()=>r,X0:()=>u});var a=n(4552);function r(t,e){return e===a.jN.ONE_TIME?t:t*function(t){switch(t){case a.jN.DAILY:return 30.44;case a.jN.WEEKLY:return 4.33;case a.jN.BIWEEKLY:return 2.17;case a.jN.MONTHLY:return 1;case a.jN.QUARTERLY:return 1/3;case a.jN.YEARLY:return 1/12;case a.jN.ONE_TIME:return 0;default:return 1}}(e)}function o(t){return t<1e3?100*Math.round(t/100):1e3*Math.round(t/1e3)}function l(t){switch(t){case a.bx.CRITICAL:return 1.5;case a.bx.HIGH:return 1.2;case a.bx.MEDIUM:return 1;case a.bx.LOW:return .7;default:return 1}}function u(t){var e;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},u={...{months:12,startingBalance:t.currentBalance||0,startDate:new Date,includeGoalContributions:!0,conservativeMode:!1},...n},i=[],c=u.startingBalance,s=new Map;t.goals.forEach(t=>{s.set(t.id,{goal:t,currentAmount:t.currentAmount})});for(let e=0;e<u.months;e++){let n=new Date(u.startDate||new Date);n.setMonth(n.getMonth()+e),n.setDate(1);let m="".concat(n.getFullYear(),"-").concat((n.getMonth()+1).toString().padStart(2,"0")),h=c,g=[],M=0;for(let e of t.income)if(function(t,e){if(!t.isActive)return!1;let n=new Date(t.startDate),r=t.endDate?new Date(t.endDate):null;if(t.frequency===a.jN.ONE_TIME){let t=new Date(n.getFullYear(),n.getMonth(),1),a=new Date(e.getFullYear(),e.getMonth(),1);return t.getTime()===a.getTime()}return!(e<n)&&(!r||!(e>r))}(e,n)){let t=r(e.amount,e.frequency);u.conservativeMode&&(t*=.9),g.push({id:e.id,name:e.name,amount:t}),M+=t}let f=[],d=0;for(let e of t.expenses)if(function(t,e){if(!t.isActive)return!1;if(t.isInstallment&&t.installmentStartMonth&&t.installmentMonths){let n=new Date(t.installmentStartMonth+"-01T00:00:00.000Z"),a=new Date(n);a.setUTCMonth(a.getUTCMonth()+t.installmentMonths-1);let r=new Date(e.getFullYear(),e.getMonth(),1),o=new Date(Date.UTC(r.getFullYear(),r.getMonth(),1));return o>=n&&o<=a}if(t.recurring&&t.frequency){let n=new Date(t.dueDate),r=new Date(e.getFullYear(),e.getMonth(),1),o=new Date(n.getFullYear(),n.getMonth(),1);switch(t.frequency){case a.jN.YEARLY:return r.getMonth()===o.getMonth();case a.jN.QUARTERLY:let l=(r.getFullYear()-o.getFullYear())*12+(r.getMonth()-o.getMonth());return l>=0&&l%3==0;case a.jN.MONTHLY:case a.jN.WEEKLY:case a.jN.BIWEEKLY:case a.jN.DAILY:default:return!0}}let n=new Date(t.dueDate),r=new Date(e.getFullYear(),e.getMonth(),1),o=new Date(e.getFullYear(),e.getMonth()+1,0);return n>=r&&n<=o}(e,n)){let t,l;if((t=e.isInstallment&&e.installmentMonths?o(t=e.amount/e.installmentMonths):e.recurring&&e.frequency?e.frequency===a.jN.YEARLY||e.frequency===a.jN.QUARTERLY?e.amount:r(e.amount,e.frequency):e.amount)<0&&(console.warn("⚠️  Negative expense amount calculated for ".concat(e.name,": ").concat(t)),t=0),u.conservativeMode&&(t*=1.1),e.isInstallment&&e.installmentStartMonth&&e.installmentMonths){let t=new Date(e.installmentStartMonth+"-01T00:00:00.000Z"),a=new Date(n.getFullYear(),n.getMonth(),1),r=new Date(Date.UTC(a.getFullYear(),a.getMonth(),1));l={currentMonth:(r.getUTCFullYear()-t.getUTCFullYear())*12+(r.getUTCMonth()-t.getUTCMonth())+1,totalMonths:e.installmentMonths,isInstallment:!0}}f.push({id:e.id,name:e.name,amount:t,installmentInfo:l}),d+=t}let A=c+M-d,D=[],E=0;if(u.includeGoalContributions){let t=M-d;if(t>0||A>0){let e=Math.max(0,Math.min(t,A));if(e>0){let t=function(t,e,n){let r=t.filter(t=>t.isActive).sort((t,e)=>(t.priorityOrder||999)-(e.priorityOrder||999)),u=[],i=e,c=Math.min(2,Math.max(1,e/1e4));for(let t of r){if(i<=0)break;if(t.goalType===a.IW.FIXED_AMOUNT&&t.currentAmount>=t.targetAmount)continue;let e=0;if(t.goalType===a.IW.FIXED_AMOUNT){let a=t.targetAmount-t.currentAmount;if(a<=0)continue;let r=new Date(t.targetDate),o=Math.max(1,Math.ceil((r.getTime()-n.getTime())/2630016e3));if(r<n)e=Math.min(a,.6*i*c);else{let t=a/o;e=Math.min(a,Math.max(t,i*Math.min(.2,.1*c)))}}else e=.15*i*c*l(t.priority);let r=Math.max(Math.min(.05*i*l(t.priority)*c,i),Math.min(e,i));t.goalType===a.IW.FIXED_AMOUNT&&(r=Math.min(r,t.targetAmount-t.currentAmount)),(r=Math.min(r=o(r),i))>0&&(u.push({id:t.id,name:t.name,amount:r}),i-=r)}return u}(Array.from(s.values()).map(t=>({...t.goal,currentAmount:t.currentAmount})),e,n);if(D.push(...t),(E=t.reduce((t,e)=>t+e.amount,0))>e){let t=e/E;D.forEach(e=>{e.amount*=t,e.amount=o(e.amount)}),E=D.reduce((t,e)=>t+e.amount,0)}D.forEach(t=>{let e=s.get(t.id);e&&(e.currentAmount+=t.amount)})}}}let T=M-d-E,p=h+T,N={month:m,startingBalance:h,income:M,expenses:d,goalContributions:E,netChange:T,endingBalance:p,incomeBreakdown:g,expenseBreakdown:f,goalBreakdown:D};i.push(N),c=p}let m=i.reduce((t,e)=>t+e.income,0),h=i.reduce((t,e)=>t+e.expenses,0),g=i.reduce((t,e)=>t+e.goalContributions,0),M=(null==(e=i[i.length-1])?void 0:e.endingBalance)||0,f=i.map(t=>t.endingBalance),d=Math.min(...f),A=Math.max(...f),D=f.filter(t=>t<0).length,E={totalIncome:m,totalExpenses:h,totalGoalContributions:g,finalBalance:M,averageMonthlyIncome:m/u.months,averageMonthlyExpenses:h/u.months,averageMonthlyNet:(m-h-g)/u.months,lowestBalance:d,highestBalance:A,monthsWithNegativeBalance:D},T=t.goals.map(t=>{let e,n,r=i.reduce((e,n)=>{let a=n.goalBreakdown.find(e=>e.id===t.id);return e+((null==a?void 0:a.amount)||0)},0),o=t.currentAmount+r,l=t.targetAmount>0?o/t.targetAmount*100:0,c=r/u.months,s=function(t,e){if(t.goalType===a.IW.OPEN_ENDED)return{isAchievable:!0};let n=t.targetAmount-t.currentAmount;if(n<=0)return{isAchievable:!0};if(e<=0)return{isAchievable:!1};let r=Math.ceil(n/e),o=new Date(new Date);return o.setMonth(o.getMonth()+r),{estimatedCompletionMonth:"".concat(o.getFullYear(),"-").concat((o.getMonth()+1).toString().padStart(2,"0")),isAchievable:o<=new Date(t.targetDate)}}(t,c),m=t.currentAmount;for(let n of i){let r=n.goalBreakdown.find(e=>e.id===t.id);if(r&&(m+=r.amount,t.goalType===a.IW.FIXED_AMOUNT&&m>=t.targetAmount)){e=n.month;break}}return!e&&s.estimatedCompletionMonth&&(e=s.estimatedCompletionMonth),n=t.goalType===a.IW.OPEN_ENDED||t.currentAmount>=t.targetAmount||o>=t.targetAmount||s.isAchievable,{id:t.id,name:t.name,targetAmount:t.targetAmount,currentAmount:t.currentAmount,projectedAmount:o,projectedProgress:l,estimatedCompletionMonth:e,onTrack:n,goalType:t.goalType,averageMonthlyAllocation:c}});return{monthlyForecasts:i,summary:E,goalProgress:T}}},5426:(t,e,n)=>{n.d(e,{MY:()=>a.useFinancialActions,SO:()=>a.useFinancialState,k_:()=>a.useFinancialContext});var a=n(6930);n(3818),n(4789),n(4479)}}]);